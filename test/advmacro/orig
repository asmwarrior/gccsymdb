PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE ProjectOverview (
	dbVersion text,
	gccVersion text,
	projectRootPath text,
	-- gcc internal debug flag.
	debug boolean
);
INSERT INTO "ProjectOverview" VALUES('1.0','4.6.2','/home/zyf/src/symdb.gcc','true');
CREATE TABLE chFile (
	id integer primary key autoincrement,
	fullName text, -- absolute path.
	mtime bigint,
	sysHeader boolean
);
INSERT INTO "chFile" VALUES(1,'/home/zyf/src/symdb.gcc/test/advmacro/a.c',1319683105,'false');
INSERT INTO "chFile" VALUES(2,'/home/zyf/src/symdb.gcc//test//usr/include/c.h',1319683105,'true');
CREATE TABLE iFile (
	id integer primary key autoincrement,
	mainFileID integer, -- chFile::id.
	hasError integer, -- 0: no error; 1: c preprocess stage error; 2: c/c++ error.
	iTokenStartID bigint,
	iTokenEndID bigint,
	syntaxTreeStartID bigint,
	syntaxTreeEndID bigint
);
INSERT INTO "iFile" VALUES(1,1,0,2,0,0,0);
CREATE TABLE FileDependence (
	id integer primary key autoincrement,
	iFileID integer,
	hID integer
);
INSERT INTO "FileDependence" VALUES(1,1,1);
INSERT INTO "FileDependence" VALUES(2,1,2);
CREATE TABLE chToken (
	id integer primary key autoincrement,
	flag integer, -- see symdb document
	length integer,
	chFileID integer,
	fileOffset integer
);
INSERT INTO "chToken" VALUES(1,33554469,1,1,0);
INSERT INTO "chToken" VALUES(2,33554485,7,1,1);
INSERT INTO "chToken" VALUES(3,33554499,5,1,9);
INSERT INTO "chToken" VALUES(4,33554469,1,2,0);
INSERT INTO "chToken" VALUES(5,33554485,6,2,1);
INSERT INTO "chToken" VALUES(6,33554485,6,2,8);
INSERT INTO "chToken" VALUES(7,33554452,1,2,14);
INSERT INTO "chToken" VALUES(8,33554485,1,2,15);
INSERT INTO "chToken" VALUES(9,33554453,1,2,16);
INSERT INTO "chToken" VALUES(10,33554485,2,2,18);
INSERT INTO "chToken" VALUES(11,33554470,2,2,20);
INSERT INTO "chToken" VALUES(12,33554485,1,2,22);
INSERT INTO "chToken" VALUES(13,33554469,1,2,24);
INSERT INTO "chToken" VALUES(14,33554485,6,2,25);
INSERT INTO "chToken" VALUES(15,33554485,7,2,32);
INSERT INTO "chToken" VALUES(16,33554452,1,2,39);
INSERT INTO "chToken" VALUES(17,33554485,1,2,40);
INSERT INTO "chToken" VALUES(18,33554453,1,2,41);
INSERT INTO "chToken" VALUES(19,33554485,6,2,43);
INSERT INTO "chToken" VALUES(20,33554452,1,2,49);
INSERT INTO "chToken" VALUES(21,33554485,1,2,50);
INSERT INTO "chToken" VALUES(22,33554453,1,2,51);
INSERT INTO "chToken" VALUES(23,33554469,1,2,53);
INSERT INTO "chToken" VALUES(24,33554485,6,2,54);
INSERT INTO "chToken" VALUES(25,33554485,9,2,61);
INSERT INTO "chToken" VALUES(26,33554487,4,2,71);
INSERT INTO "chToken" VALUES(27,33554469,1,2,76);
INSERT INTO "chToken" VALUES(28,33554485,6,2,77);
INSERT INTO "chToken" VALUES(29,33554485,7,2,84);
INSERT INTO "chToken" VALUES(30,33554485,9,2,92);
INSERT INTO "chToken" VALUES(31,33554469,1,2,102);
INSERT INTO "chToken" VALUES(32,33554485,6,2,103);
INSERT INTO "chToken" VALUES(33,33554485,6,2,110);
INSERT INTO "chToken" VALUES(34,33554452,1,2,116);
INSERT INTO "chToken" VALUES(35,33554485,3,2,117);
INSERT INTO "chToken" VALUES(36,33554453,1,2,120);
INSERT INTO "chToken" VALUES(37,33554469,1,2,122);
INSERT INTO "chToken" VALUES(38,33554485,3,2,123);
INSERT INTO "chToken" VALUES(39,33554451,1,2,126);
INSERT INTO "chToken" VALUES(40,33554485,3,2,128);
INSERT INTO "chToken" VALUES(41,33554470,2,2,131);
INSERT INTO "chToken" VALUES(42,33554485,5,2,133);
INSERT INTO "chToken" VALUES(43,33554475,1,2,138);
INSERT INTO "chToken" VALUES(44,33554469,1,2,140);
INSERT INTO "chToken" VALUES(45,33554485,6,2,141);
INSERT INTO "chToken" VALUES(46,33554485,7,2,148);
INSERT INTO "chToken" VALUES(47,33554452,1,2,155);
INSERT INTO "chToken" VALUES(48,33554476,3,2,156);
INSERT INTO "chToken" VALUES(49,33554453,1,2,159);
INSERT INTO "chToken" VALUES(50,33554485,7,2,161);
INSERT INTO "chToken" VALUES(51,33554452,1,2,168);
INSERT INTO "chToken" VALUES(52,33554485,6,2,169);
INSERT INTO "chToken" VALUES(53,33554451,1,2,175);
INSERT INTO "chToken" VALUES(54,33554485,11,2,177);
INSERT INTO "chToken" VALUES(55,33554453,1,2,188);
INSERT INTO "chToken" VALUES(56,33554469,1,2,190);
INSERT INTO "chToken" VALUES(57,33554485,6,2,191);
INSERT INTO "chToken" VALUES(58,33554485,8,2,198);
INSERT INTO "chToken" VALUES(59,33554452,1,2,206);
INSERT INTO "chToken" VALUES(60,33554485,4,2,207);
INSERT INTO "chToken" VALUES(61,33554476,3,2,211);
INSERT INTO "chToken" VALUES(62,33554453,1,2,214);
INSERT INTO "chToken" VALUES(63,33554485,7,2,216);
INSERT INTO "chToken" VALUES(64,33554452,1,2,223);
INSERT INTO "chToken" VALUES(65,33554485,6,2,224);
INSERT INTO "chToken" VALUES(66,33554451,1,2,230);
INSERT INTO "chToken" VALUES(67,33554485,4,2,232);
INSERT INTO "chToken" VALUES(68,33554453,1,2,236);
INSERT INTO "chToken" VALUES(69,33554469,1,1,15);
INSERT INTO "chToken" VALUES(70,33554485,6,1,16);
INSERT INTO "chToken" VALUES(71,33554485,1,1,23);
INSERT INTO "chToken" VALUES(72,33554485,6,1,28);
INSERT INTO "chToken" VALUES(73,33554452,1,1,34);
INSERT INTO "chToken" VALUES(74,33554485,7,1,35);
INSERT INTO "chToken" VALUES(75,33554453,1,1,42);
INSERT INTO "chToken" VALUES(76,33554485,7,1,47);
INSERT INTO "chToken" VALUES(77,33554452,1,1,54);
INSERT INTO "chToken" VALUES(78,33554485,7,1,55);
INSERT INTO "chToken" VALUES(79,33554453,1,1,62);
INSERT INTO "chToken" VALUES(80,33554485,6,1,67);
INSERT INTO "chToken" VALUES(81,33554452,1,1,73);
INSERT INTO "chToken" VALUES(82,33554485,2,1,74);
INSERT INTO "chToken" VALUES(83,33554453,1,1,76);
INSERT INTO "chToken" VALUES(84,33554485,7,1,81);
INSERT INTO "chToken" VALUES(85,33554452,1,1,88);
INSERT INTO "chToken" VALUES(86,33554493,4,1,89);
INSERT INTO "chToken" VALUES(87,33554451,1,1,93);
INSERT INTO "chToken" VALUES(88,33554487,1,1,95);
INSERT INTO "chToken" VALUES(89,33554453,1,1,96);
INSERT INTO "chToken" VALUES(90,33554485,8,1,101);
INSERT INTO "chToken" VALUES(91,33554452,1,1,109);
INSERT INTO "chToken" VALUES(92,33554493,4,1,110);
INSERT INTO "chToken" VALUES(93,33554451,1,1,114);
INSERT INTO "chToken" VALUES(94,33554485,7,1,116);
INSERT INTO "chToken" VALUES(95,33554453,1,1,123);
INSERT INTO "chToken" VALUES(96,50341941,4,1,126);
INSERT INTO "chToken" VALUES(97,50331701,3,1,131);
INSERT INTO "chToken" VALUES(98,50331668,1,1,134);
INSERT INTO "chToken" VALUES(99,50341941,4,1,135);
INSERT INTO "chToken" VALUES(100,50331669,1,1,139);
INSERT INTO "chToken" VALUES(101,50331689,1,1,141);
INSERT INTO "chToken" VALUES(102,16777269,1,1,144);
INSERT INTO "chToken" VALUES(103,50331691,1,1,145);
INSERT INTO "chToken" VALUES(104,50331690,1,1,147);
CREATE TABLE MacroDescription (
	id integer primary key autoincrement,
	leaderchTokenID bigint,
	expandedCount integer,
	macroCount integer,
	macroStartID bigint
);
INSERT INTO "MacroDescription" VALUES(1,102,1,46,1);
CREATE TABLE MacroToken (
	id integer primary key autoincrement,
	flag, -- see symdb document
	value text
);
INSERT INTO "MacroToken" VALUES(1,352321589,'AFTERX');
INSERT INTO "MacroToken" VALUES(2,352321556,'(');
INSERT INTO "MacroToken" VALUES(3,352321589,'BUFSIZE');
INSERT INTO "MacroToken" VALUES(4,352321557,')');
INSERT INTO "MacroToken" VALUES(5,335544373,'X_BUFSIZE');
INSERT INTO "MacroToken" VALUES(6,352321589,'XAFTERX');
INSERT INTO "MacroToken" VALUES(7,352321556,'(');
INSERT INTO "MacroToken" VALUES(8,352321589,'BUFSIZE');
INSERT INTO "MacroToken" VALUES(9,352321557,')');
INSERT INTO "MacroToken" VALUES(10,335544373,'X_1024');
INSERT INTO "MacroToken" VALUES(11,352321589,'COMMON');
INSERT INTO "MacroToken" VALUES(12,352321556,'(');
INSERT INTO "MacroToken" VALUES(13,352321589,'uv');
INSERT INTO "MacroToken" VALUES(14,352321557,')');
INSERT INTO "MacroToken" VALUES(15,335544381,'"uv"');
INSERT INTO "MacroToken" VALUES(16,335544339,',');
INSERT INTO "MacroToken" VALUES(17,335544373,'uv_book');
INSERT INTO "MacroToken" VALUES(18,67108907,';');
INSERT INTO "MacroToken" VALUES(19,352321589,'EPRINTF');
INSERT INTO "MacroToken" VALUES(20,352321556,'(');
INSERT INTO "MacroToken" VALUES(21,352321597,'"%d"');
INSERT INTO "MacroToken" VALUES(22,352321555,',');
INSERT INTO "MacroToken" VALUES(23,352321591,'1');
INSERT INTO "MacroToken" VALUES(24,352321557,')');
INSERT INTO "MacroToken" VALUES(25,335544373,'fprintf');
INSERT INTO "MacroToken" VALUES(26,335544340,'(');
INSERT INTO "MacroToken" VALUES(27,335544373,'stderr');
INSERT INTO "MacroToken" VALUES(28,335544339,',');
INSERT INTO "MacroToken" VALUES(29,335544381,'"%d"');
INSERT INTO "MacroToken" VALUES(30,335544339,',');
INSERT INTO "MacroToken" VALUES(31,335544375,'1');
INSERT INTO "MacroToken" VALUES(32,335544341,')');
INSERT INTO "MacroToken" VALUES(33,352321589,'EPRINTF2');
INSERT INTO "MacroToken" VALUES(34,352321556,'(');
INSERT INTO "MacroToken" VALUES(35,352321597,'"%d"');
INSERT INTO "MacroToken" VALUES(36,352321555,',');
INSERT INTO "MacroToken" VALUES(37,352321589,'BUFSIZE');
INSERT INTO "MacroToken" VALUES(38,352321557,')');
INSERT INTO "MacroToken" VALUES(39,335544373,'fprintf');
INSERT INTO "MacroToken" VALUES(40,335544340,'(');
INSERT INTO "MacroToken" VALUES(41,335544373,'stderr');
INSERT INTO "MacroToken" VALUES(42,335544339,',');
INSERT INTO "MacroToken" VALUES(43,335544381,'"%d"');
INSERT INTO "MacroToken" VALUES(44,335544339,',');
INSERT INTO "MacroToken" VALUES(45,335544375,'1024');
INSERT INTO "MacroToken" VALUES(46,335544341,')');
CREATE TABLE iToken (
	id integer primary key autoincrement,
	flag integer, -- see symdb document
	length integer,
	value text,
	relattedTokenID bigint -- chToken::id or MacroToken::id.
);
INSERT INTO "iToken" VALUES(1,NULL,NULL,NULL,NULL);
INSERT INTO "iToken" VALUES(2,33554469,1,'#',1);
INSERT INTO "iToken" VALUES(3,33554485,7,'include',2);
INSERT INTO "iToken" VALUES(4,33554499,5,'<c.h>',3);
INSERT INTO "iToken" VALUES(5,33554469,1,'#',4);
INSERT INTO "iToken" VALUES(6,33554485,6,'define',5);
INSERT INTO "iToken" VALUES(7,33554485,6,'AFTERX',6);
INSERT INTO "iToken" VALUES(8,33554452,1,'(',7);
INSERT INTO "iToken" VALUES(9,33554485,1,'x',8);
INSERT INTO "iToken" VALUES(10,33554453,1,')',9);
INSERT INTO "iToken" VALUES(11,33554485,2,'X_',10);
INSERT INTO "iToken" VALUES(12,33554470,2,'##',11);
INSERT INTO "iToken" VALUES(13,33554485,1,'x',12);
INSERT INTO "iToken" VALUES(14,33554469,1,'#',13);
INSERT INTO "iToken" VALUES(15,33554485,6,'define',14);
INSERT INTO "iToken" VALUES(16,33554485,7,'XAFTERX',15);
INSERT INTO "iToken" VALUES(17,33554452,1,'(',16);
INSERT INTO "iToken" VALUES(18,33554485,1,'x',17);
INSERT INTO "iToken" VALUES(19,33554453,1,')',18);
INSERT INTO "iToken" VALUES(20,33554485,6,'AFTERX',19);
INSERT INTO "iToken" VALUES(21,33554452,1,'(',20);
INSERT INTO "iToken" VALUES(22,33554485,1,'x',21);
INSERT INTO "iToken" VALUES(23,33554453,1,')',22);
INSERT INTO "iToken" VALUES(24,33554469,1,'#',23);
INSERT INTO "iToken" VALUES(25,33554485,6,'define',24);
INSERT INTO "iToken" VALUES(26,33554485,9,'TABLESIZE',25);
INSERT INTO "iToken" VALUES(27,33554487,4,'1024',26);
INSERT INTO "iToken" VALUES(28,33554469,1,'#',27);
INSERT INTO "iToken" VALUES(29,33554485,6,'define',28);
INSERT INTO "iToken" VALUES(30,33554485,7,'BUFSIZE',29);
INSERT INTO "iToken" VALUES(31,33554485,9,'TABLESIZE',30);
INSERT INTO "iToken" VALUES(32,33554469,1,'#',31);
INSERT INTO "iToken" VALUES(33,33554485,6,'define',32);
INSERT INTO "iToken" VALUES(34,33554485,6,'COMMON',33);
INSERT INTO "iToken" VALUES(35,33554452,1,'(',34);
INSERT INTO "iToken" VALUES(36,33554485,3,'str',35);
INSERT INTO "iToken" VALUES(37,33554453,1,')',36);
INSERT INTO "iToken" VALUES(38,33554469,1,'#',37);
INSERT INTO "iToken" VALUES(39,33554485,3,'str',38);
INSERT INTO "iToken" VALUES(40,33554451,1,',',39);
INSERT INTO "iToken" VALUES(41,33554485,3,'str',40);
INSERT INTO "iToken" VALUES(42,33554470,2,'##',41);
INSERT INTO "iToken" VALUES(43,33554485,5,'_book',42);
INSERT INTO "iToken" VALUES(44,33554475,1,';',43);
INSERT INTO "iToken" VALUES(45,33554469,1,'#',44);
INSERT INTO "iToken" VALUES(46,33554485,6,'define',45);
INSERT INTO "iToken" VALUES(47,33554485,7,'EPRINTF',46);
INSERT INTO "iToken" VALUES(48,33554452,1,'(',47);
INSERT INTO "iToken" VALUES(49,33554476,3,'...',48);
INSERT INTO "iToken" VALUES(50,33554453,1,')',49);
INSERT INTO "iToken" VALUES(51,33554485,7,'fprintf',50);
INSERT INTO "iToken" VALUES(52,33554452,1,'(',51);
INSERT INTO "iToken" VALUES(53,33554485,6,'stderr',52);
INSERT INTO "iToken" VALUES(54,33554451,1,',',53);
INSERT INTO "iToken" VALUES(55,33554485,11,'__VA_ARGS__',54);
INSERT INTO "iToken" VALUES(56,33554453,1,')',55);
INSERT INTO "iToken" VALUES(57,33554469,1,'#',56);
INSERT INTO "iToken" VALUES(58,33554485,6,'define',57);
INSERT INTO "iToken" VALUES(59,33554485,8,'EPRINTF2',58);
INSERT INTO "iToken" VALUES(60,33554452,1,'(',59);
INSERT INTO "iToken" VALUES(61,33554485,4,'args',60);
INSERT INTO "iToken" VALUES(62,33554476,3,'...',61);
INSERT INTO "iToken" VALUES(63,33554453,1,')',62);
INSERT INTO "iToken" VALUES(64,33554485,7,'fprintf',63);
INSERT INTO "iToken" VALUES(65,33554452,1,'(',64);
INSERT INTO "iToken" VALUES(66,33554485,6,'stderr',65);
INSERT INTO "iToken" VALUES(67,33554451,1,',',66);
INSERT INTO "iToken" VALUES(68,33554485,4,'args',67);
INSERT INTO "iToken" VALUES(69,33554453,1,')',68);
INSERT INTO "iToken" VALUES(70,33554469,1,'#',69);
INSERT INTO "iToken" VALUES(71,33554485,6,'define',70);
INSERT INTO "iToken" VALUES(72,33554485,1,'X',71);
INSERT INTO "iToken" VALUES(73,33554485,6,'AFTERX',72);
INSERT INTO "iToken" VALUES(74,33554452,1,'(',73);
INSERT INTO "iToken" VALUES(75,33554485,7,'BUFSIZE',74);
INSERT INTO "iToken" VALUES(76,33554453,1,')',75);
INSERT INTO "iToken" VALUES(77,33554485,7,'XAFTERX',76);
INSERT INTO "iToken" VALUES(78,33554452,1,'(',77);
INSERT INTO "iToken" VALUES(79,33554485,7,'BUFSIZE',78);
INSERT INTO "iToken" VALUES(80,33554453,1,')',79);
INSERT INTO "iToken" VALUES(81,33554485,6,'COMMON',80);
INSERT INTO "iToken" VALUES(82,33554452,1,'(',81);
INSERT INTO "iToken" VALUES(83,33554485,2,'uv',82);
INSERT INTO "iToken" VALUES(84,33554453,1,')',83);
INSERT INTO "iToken" VALUES(85,33554485,7,'EPRINTF',84);
INSERT INTO "iToken" VALUES(86,33554452,1,'(',85);
INSERT INTO "iToken" VALUES(87,33554493,4,'"%d"',86);
INSERT INTO "iToken" VALUES(88,33554451,1,',',87);
INSERT INTO "iToken" VALUES(89,33554487,1,'1',88);
INSERT INTO "iToken" VALUES(90,33554453,1,')',89);
INSERT INTO "iToken" VALUES(91,33554485,8,'EPRINTF2',90);
INSERT INTO "iToken" VALUES(92,33554452,1,'(',91);
INSERT INTO "iToken" VALUES(93,33554493,4,'"%d"',92);
INSERT INTO "iToken" VALUES(94,33554451,1,',',93);
INSERT INTO "iToken" VALUES(95,33554485,7,'BUFSIZE',94);
INSERT INTO "iToken" VALUES(96,33554453,1,')',95);
INSERT INTO "iToken" VALUES(97,50341941,4,'void',96);
INSERT INTO "iToken" VALUES(98,50331701,3,'foo',97);
INSERT INTO "iToken" VALUES(99,50331668,1,'(',98);
INSERT INTO "iToken" VALUES(100,50341941,4,'void',99);
INSERT INTO "iToken" VALUES(101,50331669,1,')',100);
INSERT INTO "iToken" VALUES(102,50331689,1,'{',101);
INSERT INTO "iToken" VALUES(103,16777269,1,'X',102);
INSERT INTO "iToken" VALUES(104,67108917,9,'X_BUFSIZE',5);
INSERT INTO "iToken" VALUES(105,67108917,6,'X_1024',10);
INSERT INTO "iToken" VALUES(106,67108925,4,'"uv"',15);
INSERT INTO "iToken" VALUES(107,67108883,1,',',16);
INSERT INTO "iToken" VALUES(108,67108917,7,'uv_book',17);
INSERT INTO "iToken" VALUES(109,67108907,1,';',18);
INSERT INTO "iToken" VALUES(110,67108917,7,'fprintf',25);
INSERT INTO "iToken" VALUES(111,67108884,1,'(',26);
INSERT INTO "iToken" VALUES(112,67108917,6,'stderr',27);
INSERT INTO "iToken" VALUES(113,67108883,1,',',28);
INSERT INTO "iToken" VALUES(114,67108925,4,'"%d"',29);
INSERT INTO "iToken" VALUES(115,67108883,1,',',30);
INSERT INTO "iToken" VALUES(116,67108919,1,'1',31);
INSERT INTO "iToken" VALUES(117,67108885,1,')',32);
INSERT INTO "iToken" VALUES(118,67108917,7,'fprintf',39);
INSERT INTO "iToken" VALUES(119,67108884,1,'(',40);
INSERT INTO "iToken" VALUES(120,67108917,6,'stderr',41);
INSERT INTO "iToken" VALUES(121,67108883,1,',',42);
INSERT INTO "iToken" VALUES(122,67108925,4,'"%d"',43);
INSERT INTO "iToken" VALUES(123,67108883,1,',',44);
INSERT INTO "iToken" VALUES(124,67108919,4,'1024',45);
INSERT INTO "iToken" VALUES(125,67108885,1,')',46);
INSERT INTO "iToken" VALUES(126,50331691,1,';',103);
INSERT INTO "iToken" VALUES(127,50331690,1,'}',104);
CREATE TABLE SyntaxTree (
	id integer primary key autoincrement,
	code integer,
	-- To compound-statement tree, store start/end treeID.
	-- To VAR_DECL, FUNCTION_DECL etc. value = SemanticTree::id.
	value blob,
	parentTreeID integer -- store relative treeID of compound-statement head.
);
CREATE TABLE CompountStatment (
	id integer primary key autoincrement,
	code integer,
	value integer,
	value2 integer,
	parentTreeID integer
);
CREATE TABLE SemanticTree (
	id integer primary key autoincrement,
	syntaxTreeID integer,
	scopeCPPTokenID integer,
	declCPPTokenID integer,
	tokenID integer -- chToken::id or MacroToken::id.
);
CREATE TABLE TemporaryTree (
	id integer primary key autoincrement,
	memAddr integer,
	code integer,
	value blob,
	parentTreeID integer
);
DELETE FROM sqlite_sequence;
INSERT INTO "sqlite_sequence" VALUES('iToken',127);
INSERT INTO "sqlite_sequence" VALUES('chFile',2);
INSERT INTO "sqlite_sequence" VALUES('iFile',1);
INSERT INTO "sqlite_sequence" VALUES('FileDependence',2);
INSERT INTO "sqlite_sequence" VALUES('chToken',104);
INSERT INTO "sqlite_sequence" VALUES('MacroDescription',1);
INSERT INTO "sqlite_sequence" VALUES('MacroToken',46);
CREATE VIEW CompileUnit as
select
	b.fullName as cFile, b.mtime as cTime, c.fullName as hFile, c.mtime as hTime
from
	iFile as a, chFile as b, chFile as c, FileDependence as d
where
	a.mainFileID = b.id and a.id = d.iFileID and c.id = d.hID;
CREATE INDEX FileName on chFile (fullName);
CREATE VIEW FileToken as
select * from
(
select
	f.id as fileID, fileOffset, t.id as tokenID, flag, length
from
	chFile f, chToken as t
where
	f.id = t.chFileID
order by
	fileID, fileOffset
) as x
left outer join
(
select
	a.id as tokenID, b.id as macroDescriptionID
from
	chToken as a, MacroDescription as b
where
	a.id = b.leaderchTokenID
) as y
on
	x.tokenID = y.tokenID;
CREATE INDEX indexTokenFromFile on chToken (chFileID, fileOffset asc);
CREATE INDEX indexMacroWeld on MacroDescription (leaderchTokenID);
CREATE TRIGGER deleteTokenFromFile delete on chToken
begin
	delete from MacroDescription where leaderchTokenID = old.id;
end;
CREATE TRIGGER deleteTokenFromFile2 delete on MacroDescription
begin
	delete from MacroToken where id >= old.macroStartID and id < old.macroStartID + old.macroCount;
end;
COMMIT;
